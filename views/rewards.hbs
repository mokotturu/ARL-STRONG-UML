<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="Monish Reddy Kotturu">
	<meta name="keywords" content="search, rescue, simulation, human, agents, trust, arl, arl strong, umass lowell">
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="/css/survey.css">
	<link rel="icon" href="/img/favicon.png" type="image/png">
	<script src="https://kit.fontawesome.com/4240eddcaa.js" crossorigin="anonymous"></script>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<title>ARL STRONG UML | Rewards</title>

	<!-- Load the CDN first -->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

	<!-- If CDN fails to load, then serve up the local version -->
	<script>window.jQuery || document.write('<script src="js/jquery-3.5.1.min.js"><\/script>')</script>
</head>

<style>
	.popup-modal-container {
		padding: 0;
	}

	.horizontalCenter {
		width: 100%;
		display: flex;
		justify-content: center;
		align-items: center;
	}

	#rewardsContent {
		padding: 3em;
		margin: 10em;
	}

	#rewardsTitle {
		text-align: center;
		font-size: 30px;
		font-weight: normal;
	}

	.optionsContainer {
		display: flex;
		justify-content: space-evenly;
		align-items: center;
	}

	.optionsContainer input {
		margin-right: 1em;
	}
	
	.popup-modal h4 {
		margin: 0.5em 0 1em 0;
		font-size: 18px;
		line-height: 160%;
		font-weight: normal;
		text-align: left;
	}

	.grid-item {
		display: flex;
		align-items: center;
		background-color: rgb(100, 100, 100);
		border-radius: 7px;
		border: none;
		padding: 10px;
		margin: 5px;
	}

	#rewardRedTitle {
		text-align: center;
	}
</style>

<body>
	<nav>
		<a href="/">ARL STRONG</a>
	</nav>

	<div class="main-content">
		<div class="body-wrapper survey" style="height: 70vh; display: flex; justify-content: center; align-items: center;">
			<div class="rewards-block" id="">
				<h3>Additional Rewards!</h3>
				<p style="font-size: 22px;">In addition to the amount earned for playing the game, you will receive an additional payment that is calculated from the highest score of two scores in this game. For every 100 points of the highest of the two scores, $0.10 is added to the additional payment. (ex: For a team score of 1400 points and an individual score of 1000 points, the addition payment is $1.40)</p>
				<div class="horizontalCenter"><button id="confirm-button" style="margin: 1em; padding: 0.7em 1.25em;font-size: 22px;" onclick="showQuiz();">OK</button></div>
			</div>
		</div>
		<div class="popup-modal-container" id="rewardsContainer">
			<div class="popup-modal" id="rewardsContent">
				<h1 id="rewardsTitle">Please respond to the following question:</h1>
				<form name="rewardsSurvey" id="rewardsSurvey" onsubmit="return false;">
					<div class="questionContainer">
						<h4 id="rewardsQ1">
							If you gain 700 points in the game, how much will be your extra payment?
							<sup style="font-size: 11px;color: red;">*</sup>
						</h4>
						<div class="optionsContainer">
							<label for="oneOneInput"   class="radio-inline grid-item" id="oneOneLabel"><input id="oneOneInput"     type="radio"  name="rewardAmount1" value="1400c" required>$1.40</label>
							<label for="oneTwoInput"   class="radio-inline grid-item" id="oneTwoLabel"><input id="oneTwoInput"     type="radio"  name="rewardAmount1" value="70c"   required>$0.70</label>
							<label for="oneThreeInput" class="radio-inline grid-item" id="oneThreeLabel"><input id="oneThreeInput" type="radio"  name="rewardAmount1" value="4000c" required>$4.00</label>
							<label for="oneFourInput"  class="radio-inline grid-item" id="oneFourLabel"><input id="oneFourInput"   type="radio"  name="rewardAmount1" value="1200c" required>$1.20</label>
						</div>
					</div>
				</form>
				<div class="userInputButtons">
					<button id="submitRewardsQ" onclick="validateUser()">Submit</button>
				</div>
			</div>
		</div>
		<div class="popup-modal-container" id="redirectRewardContainer">
			<div class="popup-modal" id="redirectRewardContent">
				<h4 id="rewardRedTitle"></h4>
				<div class="userInputButtons">
					<button id="redirectRedirectButton" onclick="rewardRedirect()"></button>
				</div>	
			</div>
		</div>
	</div>

	<div id="backToTop" onclick="backToTop()"><span class="material-icons">expand_less</span></div>

	<footer>
		<h1>ARL STRONG - University of Massachusetts Lowell</h1>
		<a href="https://github.com/mokotturu/ARL-STRONG-UML" target="_blank"><i class="fab fa-github fa-2x"></i></a>
	</footer>
</body>

<script>
	$(document).ready(() => {
		// if on small screen
		if (window.location.pathname != '/mobile' && window.innerWidth < 1000) window.location.href = '/mobile';
		
		// if not uuid
		if (window.location.pathname != '/' && !sessionStorage.getItem('uuid')) window.location.href = '/';

		if (localStorage.getItem('passedRewardsQuiz') == 'false') window.location.href = '/';

		$(document).scroll(() => {
			$('nav').toggleClass('scrolled', $(this).scrollTop() > $('nav').height());
			$('nav a').toggleClass('scrolled', $(this).scrollTop() > $('nav').height());
			$('#backToTop').toggleClass('scrolled', $(this).scrollTop() > $('nav').height());
		});
	});

	function backToTop() {
		$(document).scrollTop(-99999);
	}

	function showQuiz() {
		$('#rewardsContainer').css('display', 'flex');
		$('#rewardsContainer').css('opacity', '1');
		$('#rewardsContainer').css('visibility', 'visible');
	}

	function validateUser() {
		if ($('#rewardsSurvey').serialize() == 'rewardAmount1=70c') {
			$('#rewardRedTitle').text(`Well done!`);
			$('#redirectRedirectButton').text(`Start game`);
			localStorage.setItem('passedRewardsQuiz', true);
			showFinal();
		} else if ($('#rewardsSurvey').serialize() == '') {
			$('#rewardsSurvey').append(`<p style="font-size=14px; color: red;">Please select at least one option.</p>`);
		} else {
			$('#rewardRedTitle').text(`Sorry, your answer is incorrect. Please follow the tutorial again to play the game.`);
			$('#redirectRedirectButton').text(`Replay tutorial`);
			localStorage.setItem('passedRewardsQuiz', false);
			showFinal();
		}
	}

	function showFinal() {
		$('#rewardsContainer').css('display', 'none');
		$('#rewardsContainer').css('opacity', '0');
		$('#rewardsContainer').css('visibility', 'hidden');

		
		$('#redirectRewardContainer').css('display', 'flex');
		$('#redirectRewardContainer').css('opacity', '1');
		$('#redirectRewardContainer').css('visibility', 'visible');
	}

	function rewardRedirect() {
		if (localStorage.getItem('passedRewardsQuiz') == 'true') window.location.href = '/simulation';
		else window.location.href = '/';
	}
</script>
</html>
